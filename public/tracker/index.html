<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TeamTransport Tracker</title>

  <link rel="manifest" href="/tracker/manifest.webmanifest">
  <meta name="theme-color" content="#0d6efd">

  <!-- Bootstrap (fine for internal tool). You can replace with local assets later. -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { background: #f7f7fb; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  </style>
</head>
<body class="py-4">
  <div class="container" style="max-width: 820px;">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="h4 mb-0">TeamTransport — Tracker</h1>
      <span id="pill" class="badge text-bg-secondary">Idle</span>
    </div>

    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Vehicle ID</label>
            <input id="vehicleId" type="number" min="1" class="form-control" placeholder="e.g. 41" />
            <div class="form-text">This must match the vehicle ID in your system.</div>
          </div>

          <div class="col-md-4">
            <label class="form-label">Send interval (seconds)</label>
            <input id="intervalSec" type="number" min="1" class="form-control" value="5" />
            <div class="form-text">How often to POST to /telemetry/ingest.</div>
          </div>

          <div class="col-md-4">
            <label class="form-label">Endpoint</label>
            <input id="endpoint" type="text" class="form-control" value="/telemetry/ingest" />
            <div class="form-text">Use same origin to avoid CORS issues.</div>
          </div>

          <div class="col-12 d-flex gap-2">
            <button id="btnStart" class="btn btn-primary">Start tracking</button>
            <button id="btnStop" class="btn btn-outline-secondary" disabled>Stop</button>
            <button id="btnPing" class="btn btn-outline-primary">Send one point</button>
          </div>
        </div>
      </div>
    </div>

    <div class="row g-3">
      <div class="col-lg-6">
        <div class="card shadow-sm h-100">
          <div class="card-header">Live GPS</div>
          <div class="card-body">
            <div class="mono small">
              <div>Lat: <span id="lat">—</span></div>
              <div>Lng: <span id="lng">—</span></div>
              <div>Accuracy (m): <span id="acc">—</span></div>
              <div>Speed (km/h): <span id="speed">—</span></div>
              <div>Heading (deg): <span id="heading">—</span></div>
              <div>Timestamp: <span id="ts">—</span></div>
            </div>
            <hr />
            <div class="small text-muted">
              On iPhone/Safari, background tracking is limited. Keep the screen on for best results.
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="card shadow-sm h-100">
          <div class="card-header">Status</div>
          <div class="card-body">
            <div class="mono small">
              <div>Watch ID: <span id="watchId">—</span></div>
              <div>Last sent: <span id="lastSent">—</span></div>
              <div>Queue size: <span id="queueSize">0</span></div>
              <div>Last HTTP status: <span id="lastHttp">—</span></div>
              <div class="text-danger">Last error: <span id="lastErr">—</span></div>
            </div>
            <hr />
            <div class="small">
              Tip: open your Live Map in another tab/device. You should see the marker update within seconds.
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="text-muted small mt-3">
      Use only with consent. This tool is for tracking assigned vehicles/drivers in your system.
    </div>
  </div>

  <script src="/tracker/tracker.js"></script>
</body>
</html>
